---
layout: post
categories: jvm
title: Java JIT编译器.
date: 2019-01-06 04:13:49 +0800
description: Java JIT编译器 即时编译器
keywords: Java JIT编译器 即时编译器
---
> 
将 “热点代码” 编译成本地机器码，并进行优化，完成此过程的编译器成为即时编译器。

某个方法或代码块运行特别频繁，这些代码就称为“热点代码”。

## 1. 解释器与编译器
许多主流的商用虚拟机同时包含解释器和编译器。
当程序需要迅速启动和执行的时候，解释器可以首先发挥作用，省去编译的时间，立即执行。在程序运行后，随着时间的推移，编译器逐渐发挥作用，把越来越多的代码编译成本地代码之后，可以获取更高的执行效率。

解释器抽象表现
> 输入的代码 -> [ 解释器 解释执行 ] -> 执行结果

JIT 即时编译器抽象表现
> 输入的代码 -> [ 编译器 编译 ] -> 编译后的代码 -> [ 执行 ] -> 执行结果

HotSpot虚拟机中内置两个即时编译器，分别为Client Compiler（C1编译器）和Server Compiler（C2编译器）。
C1编译器和C2编译器都将字节码编译为本地代码，但C1只进行简单、可靠的优化，C2还会启用一些高级优化，甚至还会进行一些不可靠的激进优化。



## 2. 编译对象和触发条件
在运行过程中会被即时编译器编译的“热点代码”有两类，即：

- 被多次调用的方法
- 被多次执行的循环体

判断一段代码是不是热点代码，是不是需要触发即时编译，这样的行为称为热点探测。目前主流的热点探测有两种：

- 基于采样的热点探测
- 基于计数器的热点探测

HotSpot虚拟机采用基于计数器的热点探测方法。

## 3. 编译优化技术
### 1. 公共子表达式消除
### 2. 数组边界检查消除
### 3. 方法内联
### 4. 逃逸分析





